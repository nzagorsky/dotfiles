#!/usr/bin/env bash

install_base_debian () {
    sudo apt-get update
    sudo apt-get install -y curl
    sudo apt-get install -y fd-find
    sudo apt-get install -y htop
    sudo apt-get install -y httpie
    sudo apt-get install -y iotop
    sudo apt-get install -y nodejs
    sudo apt-get install -y npm
    sudo apt-get install -y python3
    sudo apt-get install -y python3-pip
    sudo apt-get install -y ripgrep
    sudo apt-get install -y tmux
    sudo apt-get install -y universal-ctags
    sudo apt-get install -y wget
    sudo apt-get install -y zsh
}

install_base_arch () {
    sudo pacman -S --needed --noconfirm base-devel
    sudo pacman -S --needed --noconfirm ctags
    sudo pacman -S --needed --noconfirm curl
    sudo pacman -S --needed --noconfirm fd
    sudo pacman -S --needed --noconfirm fzf
    sudo pacman -S --needed --noconfirm htop
    sudo pacman -S --needed --noconfirm httpie
    sudo pacman -S --needed --noconfirm iotop
    sudo pacman -S --needed --noconfirm neovim
    sudo pacman -S --needed --noconfirm npm
    sudo pacman -S --needed --noconfirm python-pip
    sudo pacman -S --needed --noconfirm python3
    sudo pacman -S --needed --noconfirm ripgrep
    sudo pacman -S --needed --noconfirm tmux
    sudo pacman -S --needed --noconfirm zsh
}

install_npm_deps () {
    sudo npm install -g standard
    sudo npm install -g prettier
    sudo npm install -g neovim
    sudo npm install -g javascript-typescript-langserver
}

install_python_deps () {
    # Code style libs.
    pip3 install -U --user black
    pip3 install -U --user vim-vint
    pip3 install -U --user python-language-server[all]
    pip3 install -U --user jedi==0.15.2  # Until warnings in coc-nvim are fixed
    pip3 install -U --user flake8
    pip3 install -U --user radon  # dependency for flake8 that should be updated
    pip3 install -U --user bandit
    pip3 install -U --user mypy
    pip3 install -U --user pyflakes
    pip3 install -U --user pydocstyle
    pip3 install -U --user yamllint

    # Interactive shell
    pip3 install -U --user ipython
    pip3 install -U --user ipdb

    # System
    pip3 install -U --user docker-compose
    pip3 install -U --user neovim

    # Good things
    pip3 install -U --user dataset
    pip3 install -U --user awscli
}


neovim_appimage () {
    wget https://github.com/neovim/neovim/releases/download/stable/nvim.appimage -O ~/.local/bin/nvim; chmod a+x ~/.local/bin/nvim
}


identify_os () {
    . /etc/os-release
    echo $NAME | tr '[:upper:]' '[:lower:]'
}


main () {
    OS_DETECTED=`identify_os`

    if [ "$OS_DETECTED" == "ubuntu" ]; then
        echo "Ubuntu detected"
        install_base_debian


    elif [ "$OS_DETECTED" == "debian gnu/linux" ]; then
        echo "Ubuntu detected"
        install_base_debian

    elif [ "$OS_DETECTED" == "arch linux" ]; then
        echo "Arch detected"
        install_base_arch

    elif [ "$OS_DETECTED" == "arch linux arm" ]; then
        echo "Arch detected"
        install_base_arch
    fi

    install_npm_deps
    install_python_deps
}


main > /dev/null

